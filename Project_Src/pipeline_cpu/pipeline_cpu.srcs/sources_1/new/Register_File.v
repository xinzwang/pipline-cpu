`timescale 1ns / 1ps
//////////////////////////////////////////////////////////////////////////////////
// Company: 
// Engineer: 
// 
// Create Date: 2021/08/30 14:16:21
// Design Name: wsc
// Module Name: Register_File
// Project Name: 
// Target Devices: 
// Tool Versions: 
// Description: 
// 
// Dependencies: 
// 
// Revision:
// Revision 0.01 - File Created
// Additional Comments:
// 
//////////////////////////////////////////////////////////////////////////////////

module Register_File(
	input	wire		clk,//å¤ä½ä¿¡å·ï¼Œé«˜ç”µå¹³æœ‰æ•ˆ
	input   wire	    rst,//æ—¶é’Ÿä¿¡å·

	//å†™ç«¯å?
	input wire			I_FromMEM_WB_we,//å†™ä½¿èƒ½ä¿¡å?
	input wire[4:0]		I_FromMEM_WB_waddr,//è¦å†™å…¥çš„å¯„å­˜å™¨åœ°å?
	input wire[31:0]	I_FromMEM_WB_wdata,//è¦å†™å…¥çš„æ•°æ®
	
	//è¯»ç«¯å?1
	input wire			I_FromID_re1,//ç¬¬ä¸€ä¸ªè¯»å¯„å­˜å™¨ç«¯å£è¯»ä½¿èƒ½ä¿¡å·
	input wire[4:0]		I_FromID_raddr1,//ç¬¬ä¸€ä¸ªè¯»å¯„å­˜å™¨ç«¯å£è¦è¯»å–çš„å¯„å­˜å™¨çš„åœ°å?
	output reg[31:0]    O_ToID_rdata1,//ç¬¬ä¸€ä¸ªè¯»å¯„å­˜å™¨ç«¯å£è¾“å‡ºçš„å¯„å­˜å™¨å??
	
	//è¯»ç«¯å?2
	input wire			I_FromID_re2,//ç¬¬äºŒä¸ªè¯»å¯„å­˜å™¨ç«¯å£è¯»ä½¿èƒ½ä¿¡å·
	input wire[4:0]	    I_FromID_raddr2,////ç¬¬äºŒä¸ªè¯»å¯„å­˜å™¨ç«¯å£è¦è¯»å–çš„å¯„å­˜å™¨çš„åœ°å?
	output reg[31:0]    O_ToID_rdata2//ç¬¬äºŒä¸ªè¯»å¯„å­˜å™¨ç«¯å£è¾“å‡ºçš„å¯„å­˜å™¨å??
);

	reg[31:0]  RF_regs_local[0:31];//å®šä¹‰32ä¸?32ä½å¯„å­˜å™¨


//å†™æ“ä½?
	always @ (posedge clk) begin
		if (rst == 1'b1) begin
			if((I_FromMEM_WB_we == 1'b1) && (I_FromMEM_WB_waddr != 5'h0)) begin
				RF_regs_local[I_FromMEM_WB_waddr] <= I_FromMEM_WB_wdata;
			end
		end
	end
/* å®ç°äº†å†™å¯„å­˜å™¨æ“ä½œï¼Œå½“å¤ä½ä¿¡å·æ— æ•ˆæ—¶ï¼Œåœ¨å†™ä½¿èƒ½ä¿¡å·i_frommem_wb_weæœ‰æ•ˆï¼?
ä¸”å†™æ“ä½œç›®çš„å¯„å­˜å™¨ä¸ç­‰äº0çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥å°†å†™è¾“å…¥æ•°æ®ä¿å­˜åˆ°ç›®çš„å¯„å­˜å™¨ã??
ä¹‹æ‰€ä»¥è¦åˆ¤æ–­ç›®çš„å¯„å­˜å™¨ä¸ä¸?0ï¼Œæ˜¯å› ä¸ºMIPS32æ¶æ„è§„å®šS0çš„å?¼åªèƒ½ä¸º0ï¼Œæ‰€ä»¥ä¸è¦å†™å…¥ã??*/
	
//è¯»ç«¯å?1æ“ä½œ
	always @ (*) begin
		if(rst == 1'b0) begin
			  O_ToID_rdata1 <= 32'h00000000;
	  end else if(I_FromID_raddr1 == 5'h0) begin
	  		O_ToID_rdata1 <= 32'h00000000;
	  end else if((I_FromID_raddr1 == I_FromMEM_WB_waddr) && (I_FromMEM_WB_we == 1'b1) 
	  	            && (I_FromID_re1 == 1'b1)) begin
	  	  O_ToID_rdata1 <= I_FromMEM_WB_wdata;//åœ¨è¯»æ“ä½œä¸­æœ‰ä¸?ä¸ªåˆ¤æ–­ï¼Œå¦‚æœè¦è¯»å–çš„å¯„å­˜å™¨æ˜¯åœ¨ä¸‹ä¸?ä¸ªæ—¶é’Ÿä¸Šå‡æ²¿è¦å†™å…¥çš„å¯„å­˜å™¨ï¼Œé‚£ä¹ˆå°±å°†è¦å†™å…¥çš„æ•°æ®ç›´æ¥ä½œä¸ºç»“æœè¾“å‡ºã€‚å¦‚æ­¤å°±è§£å†³äº†ç›¸éš?2æ¡æŒ‡ä»¤å­˜åœ¨æ•°æ®ç›¸å…³çš„æƒ…å†µã€?
	  end else if(I_FromID_re1 == 1'b1) begin
	      O_ToID_rdata1 <= RF_regs_local[I_FromID_raddr1];
	  end else begin
	      O_ToID_rdata1 <= 32'h00000000;
	  end
	end
/* å®ç°äº†ç¬¬ä¸?ä¸ªè¯»å¯„å­˜å™¨ç«¯å£ï¼Œåˆ†ä»¥ä¸‹å‡ æ­¥ä¾æ¬¡åˆ¤æ–?:
å½“å¤ä½ä¿¡å·æœ‰æ•ˆæ—¶ï¼Œç¬¬ä¸?ä¸ªè¯»å¯„å­˜å™¨ç«¯å£çš„è¾“å‡ºå§‹ç»ˆä¸?0;å½“å¤ä½ä¿¡å·æ— æ•ˆæ—¶ï¼Œå¦‚æœè¯»å–çš„æ˜?$0ï¼Œé‚£ä¹ˆç›´æ¥ç»™å‡?0;
å¦‚æœç¬¬ä¸€ä¸ªè¯»å¯„å­˜å™¨ç«¯å£è¦è¯»å–çš„ç›®æ ‡å¯„å­˜å™¨ä¸è¦å†™å…¥çš„ç›®çš„å¯„å­˜å™¨æ˜¯åŒä¸?ä¸ªå¯„å­˜å™¨ï¼Œé‚£ä¹ˆç›´æ¥å°†è¦å†™å…¥çš„å€¼ä½œä¸ºç¬¬ä¸?ä¸ªè¯»å¯„å­˜å™¨ç«¯å£çš„è¾“å‡º;
å¦‚æœä¸Šè¿°æƒ…å†µéƒ½ä¸æ»¡è¶³,é‚£ä¹ˆç»™å‡ºç¬¬ä¸€ä¸ªè¯»å¯„å­˜å™¨ç«¯å£è¦è¯»å–çš„ç›®æ ‡å¯„å­˜å™¨åœ°å€å¯¹åº”å¯„å­˜å™¨çš„å€?;
ç¬¬ä¸€ä¸ªè¯»å¯„å­˜å™¨ç«¯å£ä¸èƒ½ä½¿ç”¨æ—¶ï¼Œç›´æ¥è¾“å‡?0ã€?*/

//è¯»ç«¯å?2æ“ä½œ
	always @ (*) begin
		if(rst == 1'b0) begin
			  O_ToID_rdata2 <= 32'h00000000;
	  end else if(I_FromID_raddr2 == 5'h0) begin
	  		O_ToID_rdata2 <= 32'h00000000;
	  end else if((I_FromID_raddr2 == I_FromMEM_WB_waddr) && (I_FromMEM_WB_we == 1'b1) 
	  	            && (I_FromID_re2 == 1'b1)) begin
	  	  O_ToID_rdata2 <= I_FromMEM_WB_wdata;
	  end else if(I_FromID_re2 == 1'b1) begin
	      O_ToID_rdata2 <= RF_regs_local[I_FromID_raddr2];
	  end else begin
	      O_ToID_rdata2 <= 32'h00000000;
	  end
	end
/* å®ç°äº†ç¬¬äºŒä¸ªè¯»å¯„å­˜å™¨ç«¯å£ï¼Œä¸ç¬¬ä¸‰æ®µç›¸ä¼¼ã??
æ³¨æ„ä¸?ç‚?:è¯»å¯„å­˜å™¨æ“ä½œæ˜¯ç»„åˆé?»è¾‘ç”µè·¯,ä¹Ÿå°±æ˜¯ä¸€æ—¦è¾“å…¥çš„è¦è¯»å–çš„å¯„å­˜å™¨åœ°å?raddr1æˆ–è?…raddr2å‘ç”Ÿå˜åŒ–ï¼?
é‚£ä¹ˆä¼šç«‹å³ç»™å‡ºæ–°åœ°å€å¯¹åº”çš„å¯„å­˜å™¨çš„å?¼ï¼Œè¿™æ ·å¯ä»¥ä¿è¯åœ¨è¯‘ç é˜¶æ®µå–å¾—è¦è¯»å–çš„å¯„å­˜å™¨çš„å?¼ï¼Œ
è€Œå†™å¯„å­˜å™¨æ“ä½œæ˜¯æ—¶åºé€»è¾‘ç”µè·¯ï¼Œå†™æ“ä½œå‘ç”Ÿåœ¨æ—¶é’Ÿä¿¡å·çš„ä¸Šå‡æ²¿ã??*/

endmodule

